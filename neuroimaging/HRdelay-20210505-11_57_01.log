/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/HRdelay.mat
05-May-2021 11:57:02
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/HRdelay.m',90,1)">90  </a>if 1
processResponses(p,figOption,verbose)
02jp: loading
02jp: processing responses (sess1/2)
02jp: processing responses (sess2/2)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processResponses.m',74,1)">74  </a>        res.sess1.voxProp = d.voxProp;
if system_dependent('IsDebugMode')==1, dbcont; end
02jp: saving responses
02jp: saving detrended data
02jp: saved to '/Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d'
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
03sk: loading
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
03sk: processing responses (sess1/2)
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
res
{Unrecognized function or variable 'res'.
} 
if system_dependent('IsDebugMode')==1, dbstep; end
res.(sess)

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
      dataDtrd: {18×1 cell}

res.(sess)

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
      dataDtrd: {18×1 cell}

res.(sess).sinDesign

ans =

         0    1.0000    1.0000         0
    0.5000    0.8660    1.0000    0.0084
    0.8660    0.5000    1.0000    0.0168
    1.0000    0.0000    1.0000    0.0252
    0.8660   -0.5000    1.0000    0.0336
    0.5000   -0.8660    1.0000    0.0420
    0.0000   -1.0000    1.0000    0.0504
   -0.5000   -0.8660    1.0000    0.0588
   -0.8660   -0.5000    1.0000    0.0672
   -1.0000   -0.0000    1.0000    0.0756
   -0.8660    0.5000    1.0000    0.0840
   -0.5000    0.8660    1.0000    0.0924
   -0.0000    1.0000    1.0000    0.1008
    0.5000    0.8660    1.0000    0.1092
    0.8660    0.5000    1.0000    0.1176
    1.0000    0.0000    1.0000    0.1261
    0.8660   -0.5000    1.0000    0.1345
    0.5000   -0.8660    1.0000    0.1429
    0.0000   -1.0000    1.0000    0.1513
   -0.5000   -0.8660    1.0000    0.1597
   -0.8660   -0.5000    1.0000    0.1681
   -1.0000   -0.0000    1.0000    0.1765
   -0.8660    0.5000    1.0000    0.1849
   -0.5000    0.8660    1.0000    0.1933
   -0.0000    1.0000    1.0000    0.2017
    0.5000    0.8660    1.0000    0.2101
    0.8660    0.5000    1.0000    0.2185
    1.0000    0.0000    1.0000    0.2269
    0.8660   -0.5000    1.0000    0.2353
    0.5000   -0.8660    1.0000    0.2437
    0.0000   -1.0000    1.0000    0.2521
   -0.5000   -0.8660    1.0000    0.2605
   -0.8660   -0.5000    1.0000    0.2689
   -1.0000   -0.0000    1.0000    0.2773
   -0.8660    0.5000    1.0000    0.2857
   -0.5000    0.8660    1.0000    0.2941
   -0.0000    1.0000    1.0000    0.3025
    0.5000    0.8660    1.0000    0.3109
    0.8660    0.5000    1.0000    0.3193
    1.0000    0.0000    1.0000    0.3277
    0.8660   -0.5000    1.0000    0.3361
    0.5000   -0.8660    1.0000    0.3445
    0.0000   -1.0000    1.0000    0.3529
   -0.5000   -0.8660    1.0000    0.3613
   -0.8660   -0.5000    1.0000    0.3697
   -1.0000   -0.0000    1.0000    0.3782
   -0.8660    0.5000    1.0000    0.3866
   -0.5000    0.8660    1.0000    0.3950
   -0.0000    1.0000    1.0000    0.4034
    0.5000    0.8660    1.0000    0.4118
    0.8660    0.5000    1.0000    0.4202
    1.0000    0.0000    1.0000    0.4286
    0.8660   -0.5000    1.0000    0.4370
    0.5000   -0.8660    1.0000    0.4454
    0.0000   -1.0000    1.0000    0.4538
   -0.5000   -0.8660    1.0000    0.4622
   -0.8660   -0.5000    1.0000    0.4706
   -1.0000   -0.0000    1.0000    0.4790
   -0.8660    0.5000    1.0000    0.4874
   -0.5000    0.8660    1.0000    0.4958
   -0.0000    1.0000    1.0000    0.5042
    0.5000    0.8660    1.0000    0.5126
    0.8660    0.5000    1.0000    0.5210
    1.0000    0.0000    1.0000    0.5294
    0.8660   -0.5000    1.0000    0.5378
    0.5000   -0.8660    1.0000    0.5462
    0.0000   -1.0000    1.0000    0.5546
   -0.5000   -0.8660    1.0000    0.5630
   -0.8660   -0.5000    1.0000    0.5714
   -1.0000   -0.0000    1.0000    0.5798
   -0.8660    0.5000    1.0000    0.5882
   -0.5000    0.8660    1.0000    0.5966
   -0.0000    1.0000    1.0000    0.6050
    0.5000    0.8660    1.0000    0.6134
    0.8660    0.5000    1.0000    0.6218
    1.0000    0.0000    1.0000    0.6303
    0.8660   -0.5000    1.0000    0.6387
    0.5000   -0.8660    1.0000    0.6471
    0.0000   -1.0000    1.0000    0.6555
   -0.5000   -0.8660    1.0000    0.6639
   -0.8660   -0.5000    1.0000    0.6723
   -1.0000   -0.0000    1.0000    0.6807
   -0.8660    0.5000    1.0000    0.6891
   -0.5000    0.8660    1.0000    0.6975
   -0.0000    1.0000    1.0000    0.7059
    0.5000    0.8660    1.0000    0.7143
    0.8660    0.5000    1.0000    0.7227
    1.0000    0.0000    1.0000    0.7311
    0.8660   -0.5000    1.0000    0.7395
    0.5000   -0.8660    1.0000    0.7479
    0.0000   -1.0000    1.0000    0.7563
   -0.5000   -0.8660    1.0000    0.7647
   -0.8660   -0.5000    1.0000    0.7731
   -1.0000   -0.0000    1.0000    0.7815
   -0.8660    0.5000    1.0000    0.7899
   -0.5000    0.8660    1.0000    0.7983
   -0.0000    1.0000    1.0000    0.8067
    0.5000    0.8660    1.0000    0.8151
    0.8660    0.5000    1.0000    0.8235
    1.0000    0.0000    1.0000    0.8319
    0.8660   -0.5000    1.0000    0.8403
    0.5000   -0.8660    1.0000    0.8487
    0.0000   -1.0000    1.0000    0.8571
   -0.5000   -0.8660    1.0000    0.8655
   -0.8660   -0.5000    1.0000    0.8739
   -1.0000   -0.0000    1.0000    0.8824
   -0.8660    0.5000    1.0000    0.8908
   -0.5000    0.8660    1.0000    0.8992
   -0.0000    1.0000    1.0000    0.9076
    0.5000    0.8660    1.0000    0.9160
    0.8660    0.5000    1.0000    0.9244
    1.0000    0.0000    1.0000    0.9328
    0.8660   -0.5000    1.0000    0.9412
    0.5000   -0.8660    1.0000    0.9496
    0.0000   -1.0000    1.0000    0.9580
   -0.5000   -0.8660    1.0000    0.9664
   -0.8660   -0.5000    1.0000    0.9748
   -1.0000   -0.0000    1.0000    0.9832
   -0.8660    0.5000    1.0000    0.9916
   -0.5000    0.8660    1.0000    1.0000

imagesc(res.(sess).sinDesign)
imagesc(res.(sess).hrDesign)
if system_dependent('IsDebugMode')==1, dbcont; end
03sk: processing responses (sess2/2)
03sk: saving responses
dbquit
visualizeFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/visualizeFeatSel.m',28,1)">28  </a>pAll = cell(size(subjList));
if system_dependent('IsDebugMode')==1, dbcont; end
whos
  Name          Size               Bytes  Class     Attributes

  condPair      1x12                  24  char                
  featSel       6x2             27204352  cell                
  funPath       1x84                 168  char                
  inDir         1x1                    2  char                
  inDirX        1x1                    2  char                
  outDir        1x1                    2  char                
  p             1x1                 9408  struct              
  pAll          6x1             69031416  cell                
  repoPath      1x59                 118  char                
  subjInd       1x1                    8  double              
  subjList      6x1                  672  cell                

pAll

pAll =

  6×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}
    {1×1 struct}
    {1×1 struct}
    {1×1 struct}
    {1×1 struct}
    {1×1 struct}

pAll{}
 pAll{}
      ↑
{Error: Invalid expression. When calling a function or indexing a
variable, use parentheses. Otherwise, check for mismatched delimiters.
} 
pAll{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          tr: 1
     stimDur: 6
    doMotion: 0
       brain: [1×1 struct]
     voxProp: [1×1 struct]
     roiMask: [128×128×13 logical]
    cropMask: [128×128×13 logical]

pAll{1}.voxProp

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          area: [1×1 struct]
    censorMask: [128×128×13 logical]
           ecc: [128×128×13 double]
           pol: [128×128×13 double]
      hemiMask: [1×1 struct]

featSel

featSel =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

featSel{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    featSeq: [1×1 struct]

featSel{1}.featSeq

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         featVal: [3419×5×4 double]
           featP: [3419×5×4 double]
       featQtile: [3419×5×4 double]
    featIndStart: [3419×5×4 logical]
       featIndIn: [3419×5×4 logical]
     featSelList: {1×5 cell}
    condPairList: {1×1×4 cell}
            info: 'vox X featSel X condPair'
           info2: 'custom2'

dbquit
processFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',2,1)">2   </a>if ~isfield(p,'figOption') || isempty(p.figOption)
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
dbquit
visualizeFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/visualizeFeatSel.m',2,1)">2   </a>if ~isfield(p,'figOption') || isempty(p.figOption)
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
whos
  Name          Size            Bytes  Class     Attributes

  condPair      1x12               24  char                
  funPath       1x84              168  char                
  inDir         1x1                 2  char                
  inDirX        1x1                 2  char                
  outDir        1x1                 2  char                
  p             1x1              9408  struct              
  repoPath      1x59              118  char                
  subjList      6x1               672  cell                
  tmp           1x1               120  cell                

p

p = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     figOption: [1×1 struct]
    termOption: [1×1 struct]
          meta: [1×1 struct]
       featSel: [1×1 struct]
           svm: [1×1 struct]
          perm: [1×1 struct]

whos
  Name          Size            Bytes  Class     Attributes

  condPair      1x12               24  char                
  funPath       1x84              168  char                
  inDir         1x1                 2  char                
  inDirX        1x1                 2  char                
  outDir        1x1                 2  char                
  p             1x1              9408  struct              
  repoPath      1x59              118  char                
  subjList      6x1               672  cell                
  tmp           1x1               120  cell                

if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
dbquit
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
Feature Selection: processing
subj1; sess1
subj2; sess1
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',87,1)">87  </a>        [featSel{subjInd,sessInd}] = getFeatSel(d{subjInd,sessInd},p,featSel_fov{subjInd,sessInd});
d

d =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

d{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
       voxProp: [1×1 struct]

if system_dependent('IsDebugMode')==1, dbstep; end
featSel{subjInd,sessInd}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    featSeq: [1×1 struct]

d

d =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

d{subjInd,sessInd}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
       voxProp: [1×1 struct]

dbquit
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',54,1)">54  </a>        dP{subjInd,sessInd} = d{subjInd}.(sessList{sessInd});
if system_dependent('IsDebugMode')==1, dbstep out; end
Feature Selection: processing
subj1; sess1
subj2; sess1
subj3; sess1
subj4; sess1
subj5; sess1
subj6; sess1
subj1; sess2
subj2; sess2
subj3; sess2
subj4; sess2
subj5; sess2
subj6; sess2
Feature Selection: saving
Feature Selection: saved to /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/featSel.mat
visualizeFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/visualizeFeatSel.m',2,1)">2   </a>if ~isfield(p,'figOption') || isempty(p.figOption)
if system_dependent('IsDebugMode')==1, dbcont; end
featSel

featSel =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

featSel{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    featSeq: [1×1 struct]
       GLMs: [1×1 struct]

featSel{1}.GLMs

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

edit runFit
edit showGLMdesign
featSel{1}.GLMs

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

showGLMdesign(featSel{1}.GLMs)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',3,1)">3   </a>f = figure('WindowStyle','docked');
f = figure('WindowStyle','docked');
GLMs

GLMs = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

GLMs

GLMs = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

run1 = GLMs.sinDesign;
run1 = GLMs.sinDesign;
tmp = run1(any(run1,2),:);
tmp(:,3) = max(tmp(:,1));
tmp(:,4) = tmp(:,4)./max(abs(tmp(:,4)));
imagesc(tmp); colormap gray
hold off
run1 = GLMs.sinDesign;
imagesc(runi); colormap gray
{Unrecognized function or variable 'runi'.
} 
imagesc(run1); colormap gray
title('Sinusoidal Response');
ax1 = gca; ax1.XTick = []; ax1.YTick = [];
ylabel('TRs');
curDesign = GLMs.sinDesign;
imagesc(curDesign); colormap gray
title('Sinusoidal Response');
ax1 = gca; ax1.XTick = []; ax1.YTick = [];
ylabel('TRs');
ax1.XTick = 1:size(curDesign,2);
ax1.Box = 'off';
ax1.TickDir = 'out';
ax1.XTickLabel = {'sin' 'cos' 'constant' 'drift' 'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''};
ax1.XTickLabelRotation = -90;
ax1.YAxis.Color = 'none';
ax1.YAxis.Label.Visible = 'on';
ax1.YAxis.Label.Color = 'k';
xVal = diff(ax1.XLim);
xWidth = ax1.Position(3);
subplot(1,16+25,0+(1:25))
curDesign = GLMs.hrDesign;
imagesc(curDesign); colormap gray
f = figure('WindowStyle','docked');

subplot(1,16+25,25+(1:16))
curDesign = GLMs.sinDesign;
imagesc(curDesign); colormap gray
title('Sinusoidal Response');
ax1 = gca; ax1.XTick = []; ax1.YTick = [];
%     xlabel('Regressors');
ylabel('TRs');
ax1.XTick = 1:size(curDesign,2);
ax1.Box = 'off';
ax1.TickDir = 'out';
ax1.XTickLabel = {'sin' 'cos' 'constant' 'drift' 'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''};
ax1.XTickLabelRotation = -90;
ax1.YAxis.Color = 'none';
ax1.YAxis.Label.Visible = 'on';
ax1.YAxis.Label.Color = 'k';
xVal = diff(ax1.XLim);
xWidth = ax1.Position(3);
subplot(1,16+25,0+(1:25))
curDesign = GLMs.hrDesign;
GLMs.hrDesign

ans =

  Columns 1 through 5

         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0

  Columns 6 through 10

         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
         0         0         0         0         0
    1.0000         0         0         0         0
         0    1.0000         0         0         0
         0         0    1.0000         0         0
         0         0         0    1.0000         0
         0         0         0         0    1.0000
         0         0         0         0         0

  Columns 11 through 13

         0    1.0000         0
         0    1.0000    0.0084
         0    1.0000    0.0168
         0    1.0000    0.0252
         0    1.0000    0.0336
         0    1.0000    0.0420
         0    1.0000    0.0504
         0    1.0000    0.0588
         0    1.0000    0.0672
         0    1.0000    0.0756
         0    1.0000    0.0840
    1.0000    1.0000    0.0924
         0    1.0000    0.1008
         0    1.0000    0.1092
         0    1.0000    0.1176
         0    1.0000    0.1261
         0    1.0000    0.1345
         0    1.0000    0.1429
         0    1.0000    0.1513
         0    1.0000    0.1597
         0    1.0000    0.1681
         0    1.0000    0.1765
         0    1.0000    0.1849
    1.0000    1.0000    0.1933
         0    1.0000    0.2017
         0    1.0000    0.2101
         0    1.0000    0.2185
         0    1.0000    0.2269
         0    1.0000    0.2353
         0    1.0000    0.2437
         0    1.0000    0.2521
         0    1.0000    0.2605
         0    1.0000    0.2689
         0    1.0000    0.2773
         0    1.0000    0.2857
    1.0000    1.0000    0.2941
         0    1.0000    0.3025
         0    1.0000    0.3109
         0    1.0000    0.3193
         0    1.0000    0.3277
         0    1.0000    0.3361
         0    1.0000    0.3445
         0    1.0000    0.3529
         0    1.0000    0.3613
         0    1.0000    0.3697
         0    1.0000    0.3782
         0    1.0000    0.3866
    1.0000    1.0000    0.3950
         0    1.0000    0.4034
         0    1.0000    0.4118
         0    1.0000    0.4202
         0    1.0000    0.4286
         0    1.0000    0.4370
         0    1.0000    0.4454
         0    1.0000    0.4538
         0    1.0000    0.4622
         0    1.0000    0.4706
         0    1.0000    0.4790
         0    1.0000    0.4874
    1.0000    1.0000    0.4958
         0    1.0000    0.5042
         0    1.0000    0.5126
         0    1.0000    0.5210
         0    1.0000    0.5294
         0    1.0000    0.5378
         0    1.0000    0.5462
         0    1.0000    0.5546
         0    1.0000    0.5630
         0    1.0000    0.5714
         0    1.0000    0.5798
         0    1.0000    0.5882
    1.0000    1.0000    0.5966
         0    1.0000    0.6050
         0    1.0000    0.6134
         0    1.0000    0.6218
         0    1.0000    0.6303
         0    1.0000    0.6387
         0    1.0000    0.6471
         0    1.0000    0.6555
         0    1.0000    0.6639
         0    1.0000    0.6723
         0    1.0000    0.6807
         0    1.0000    0.6891
    1.0000    1.0000    0.6975
         0    1.0000    0.7059
         0    1.0000    0.7143
         0    1.0000    0.7227
         0    1.0000    0.7311
         0    1.0000    0.7395
         0    1.0000    0.7479
         0    1.0000    0.7563
         0    1.0000    0.7647
         0    1.0000    0.7731
         0    1.0000    0.7815
         0    1.0000    0.7899
    1.0000    1.0000    0.7983
         0    1.0000    0.8067
         0    1.0000    0.8151
         0    1.0000    0.8235
         0    1.0000    0.8319
         0    1.0000    0.8403
         0    1.0000    0.8487
         0    1.0000    0.8571
         0    1.0000    0.8655
         0    1.0000    0.8739
         0    1.0000    0.8824
         0    1.0000    0.8908
    1.0000    1.0000    0.8992
         0    1.0000    0.9076
         0    1.0000    0.9160
         0    1.0000    0.9244
         0    1.0000    0.9328
         0    1.0000    0.9412
         0    1.0000    0.9496
         0    1.0000    0.9580
         0    1.0000    0.9664
         0    1.0000    0.9748
         0    1.0000    0.9832
         0    1.0000    0.9916
    1.0000    1.0000    1.0000

GLMs.hrDesign(:,1:end-2)

ans =

  Columns 1 through 9

     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0

  Columns 10 through 11

     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     0     0
     1     0
     0     1

curDesign = GLMs.hrDesign;

imagesc(curDesign); colormap gray
dbquit
dbquit
processResponses(p,figOption,verbose)
02jp: loading
02jp: processing responses (sess1/2)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processResponses.m',68,1)">68  </a>            res.(sess) = runGLMs(d.fun(1,sessInd),p,0);
res.(sess) = runGLMs(d.fun(1,sessInd),p,0);
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/runGLMs.m',2,1)">2   </a>if ~exist('verbose','var')
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
res1

res1 = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

        hr: [6-D double]
      base: [5-D double]
      info: 'x X y X x X rep X cond X t'
    design: [120×13 double]

res1.design

ans =

  Columns 1 through 7

         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
    1.0000         0         0         0         0         0         0
         0    1.0000         0         0         0         0         0
         0         0    1.0000         0         0         0         0
         0         0         0    1.0000         0         0         0
         0         0         0         0    1.0000         0         0
         0         0         0         0         0    1.0000         0
         0         0         0         0         0         0    1.0000
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0
         0         0         0         0         0         0         0

  Columns 8 through 13

         0         0         0         0    1.0000         0
         0         0         0         0    1.0000    0.0084
         0         0         0         0    1.0000    0.0168
         0         0         0         0    1.0000    0.0252
         0         0         0         0    1.0000    0.0336
         0         0         0         0    1.0000    0.0420
         0         0         0         0    1.0000    0.0504
         0         0         0         0    1.0000    0.0588
    1.0000         0         0         0    1.0000    0.0672
         0    1.0000         0         0    1.0000    0.0756
         0         0    1.0000         0    1.0000    0.0840
         0         0         0    1.0000    1.0000    0.0924
         0         0         0         0    1.0000    0.1008
         0         0         0         0    1.0000    0.1092
         0         0         0         0    1.0000    0.1176
         0         0         0         0    1.0000    0.1261
         0         0         0         0    1.0000    0.1345
         0         0         0         0    1.0000    0.1429
         0         0         0         0    1.0000    0.1513
         0         0         0         0    1.0000    0.1597
    1.0000         0         0         0    1.0000    0.1681
         0    1.0000         0         0    1.0000    0.1765
         0         0    1.0000         0    1.0000    0.1849
         0         0         0    1.0000    1.0000    0.1933
         0         0         0         0    1.0000    0.2017
         0         0         0         0    1.0000    0.2101
         0         0         0         0    1.0000    0.2185
         0         0         0         0    1.0000    0.2269
         0         0         0         0    1.0000    0.2353
         0         0         0         0    1.0000    0.2437
         0         0         0         0    1.0000    0.2521
         0         0         0         0    1.0000    0.2605
    1.0000         0         0         0    1.0000    0.2689
         0    1.0000         0         0    1.0000    0.2773
         0         0    1.0000         0    1.0000    0.2857
         0         0         0    1.0000    1.0000    0.2941
         0         0         0         0    1.0000    0.3025
         0         0         0         0    1.0000    0.3109
         0         0         0         0    1.0000    0.3193
         0         0         0         0    1.0000    0.3277
         0         0         0         0    1.0000    0.3361
         0         0         0         0    1.0000    0.3445
         0         0         0         0    1.0000    0.3529
         0         0         0         0    1.0000    0.3613
    1.0000         0         0         0    1.0000    0.3697
         0    1.0000         0         0    1.0000    0.3782
         0         0    1.0000         0    1.0000    0.3866
         0         0         0    1.0000    1.0000    0.3950
         0         0         0         0    1.0000    0.4034
         0         0         0         0    1.0000    0.4118
         0         0         0         0    1.0000    0.4202
         0         0         0         0    1.0000    0.4286
         0         0         0         0    1.0000    0.4370
         0         0         0         0    1.0000    0.4454
         0         0         0         0    1.0000    0.4538
         0         0         0         0    1.0000    0.4622
    1.0000         0         0         0    1.0000    0.4706
         0    1.0000         0         0    1.0000    0.4790
         0         0    1.0000         0    1.0000    0.4874
         0         0         0    1.0000    1.0000    0.4958
         0         0         0         0    1.0000    0.5042
         0         0         0         0    1.0000    0.5126
         0         0         0         0    1.0000    0.5210
         0         0         0         0    1.0000    0.5294
         0         0         0         0    1.0000    0.5378
         0         0         0         0    1.0000    0.5462
         0         0         0         0    1.0000    0.5546
         0         0         0         0    1.0000    0.5630
    1.0000         0         0         0    1.0000    0.5714
         0    1.0000         0         0    1.0000    0.5798
         0         0    1.0000         0    1.0000    0.5882
         0         0         0    1.0000    1.0000    0.5966
         0         0         0         0    1.0000    0.6050
         0         0         0         0    1.0000    0.6134
         0         0         0         0    1.0000    0.6218
         0         0         0         0    1.0000    0.6303
         0         0         0         0    1.0000    0.6387
         0         0         0         0    1.0000    0.6471
         0         0         0         0    1.0000    0.6555
         0         0         0         0    1.0000    0.6639
    1.0000         0         0         0    1.0000    0.6723
         0    1.0000         0         0    1.0000    0.6807
         0         0    1.0000         0    1.0000    0.6891
         0         0         0    1.0000    1.0000    0.6975
         0         0         0         0    1.0000    0.7059
         0         0         0         0    1.0000    0.7143
         0         0         0         0    1.0000    0.7227
         0         0         0         0    1.0000    0.7311
         0         0         0         0    1.0000    0.7395
         0         0         0         0    1.0000    0.7479
         0         0         0         0    1.0000    0.7563
         0         0         0         0    1.0000    0.7647
    1.0000         0         0         0    1.0000    0.7731
         0    1.0000         0         0    1.0000    0.7815
         0         0    1.0000         0    1.0000    0.7899
         0         0         0    1.0000    1.0000    0.7983
         0         0         0         0    1.0000    0.8067
         0         0         0         0    1.0000    0.8151
         0         0         0         0    1.0000    0.8235
         0         0         0         0    1.0000    0.8319
         0         0         0         0    1.0000    0.8403
         0         0         0         0    1.0000    0.8487
         0         0         0         0    1.0000    0.8571
         0         0         0         0    1.0000    0.8655
    1.0000         0         0         0    1.0000    0.8739
         0    1.0000         0         0    1.0000    0.8824
         0         0    1.0000         0    1.0000    0.8908
         0         0         0    1.0000    1.0000    0.8992
         0         0         0         0    1.0000    0.9076
         0         0         0         0    1.0000    0.9160
         0         0         0         0    1.0000    0.9244
         0         0         0         0    1.0000    0.9328
         0         0         0         0    1.0000    0.9412
         0         0         0         0    1.0000    0.9496
         0         0         0         0    1.0000    0.9580
         0         0         0         0    1.0000    0.9664
    1.0000         0         0         0    1.0000    0.9748
         0    1.0000         0         0    1.0000    0.9832
         0         0    1.0000         0    1.0000    0.9916
         0         0         0    1.0000    1.0000    1.0000

res1 = fitHrMixed(d,p);
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/runGLMs.m',315,1)">315 </a>excl = d.excl;
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbstep; end
d.design{runInd}

ans =

     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0     0     0
     0     0     0     0     1     0     0     0     0     0     0
     0     0     0     0     0     1     0     0     0     0     0
     0     0     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     0     0     1

figure('WindowStyle','docked');
imagesc(d.design{runInd})
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbstep; end
f

f = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    full: [1×1 struct]

f.full

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         betas: {18×1 cell}
        design: {18×1 cell}
     censorPts: {18×1 cell}
    designInfo: {18×1 cell}
          info: 'full model'

f.full.design

ans =

  18×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}
    {120×13 double}

imagesc(f.full.design{1})
f = fitMixed(d,p);
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/runGLMs.m',709,1)">709 </a>if ~exist('opt','var')
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
design(runInd)

ans =

  1×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {120×13 double}

imagesc(design{runInd})
if system_dependent('IsDebugMode')==1, dbstep in; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
imagesc(design{1})
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep out; end
if system_dependent('IsDebugMode')==1, dbstep; end
f = fitMixed(d,p);
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/runGLMs.m',709,1)">709 </a>if ~exist('opt','var')
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
imagesc(designFull{1})
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbstep out; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
if system_dependent('IsDebugMode')==1, dbcont; end
dbquit
dbquit
close all
dbquit
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
Feature Selection: processing
subj1; sess1
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('array2table', '/Applications/MATLAB_R2020b.app/toolbox/matlab/datatypes/tabular/array2table.m', 72)" style="font-weight:bold">array2table</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2020b.app/toolbox/matlab/datatypes/tabular/array2table.m',72,0)">line 72</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('RepeatedMeasuresModel/get.Coefficients', '/Applications/MATLAB_R2020b.app/toolbox/stats/classreg/RepeatedMeasuresModel.m', 1282)" style="font-weight:bold">RepeatedMeasuresModel/get.Coefficients</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2020b.app/toolbox/stats/classreg/RepeatedMeasuresModel.m',1282,0)">line 1282</a>)
            c = array2table(this.B,'VariableNames',rnames,
            'RowNames',cnames);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('RepeatedMeasuresModel/manova', '/Applications/MATLAB_R2020b.app/toolbox/stats/classreg/RepeatedMeasuresModel.m', 356)" style="font-weight:bold">RepeatedMeasuresModel/manova</a> (<a href="matlab: opentoline('/Applications/MATLAB_R2020b.app/toolbox/stats/classreg/RepeatedMeasuresModel.m',356,0)">line 356</a>)
            Beta = this.Coefficients{:,:};

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('manova2', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/manova2.m', 13)" style="font-weight:bold">manova2</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/manova2.m',13,0)">line 13</a>)
        [anovatbl,A,C,D] = manova(rm_WM,'WithinModel',withinModel);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('getFeatSel>getDiscrimStats', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m', 295)" style="font-weight:bold">getFeatSel>getDiscrimStats</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',295,0)">line 295</a>)
[TBL,A,C_MV,D,withinNames,betweenNames] =
manova2(rm,withinModel,[],statLabel);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('getFeatSel', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m', 22)" style="font-weight:bold">getFeatSel</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',22,0)">line 22</a>)
            [condStat(:,condIndPairInd),condP(:,condIndPairInd),interceptStat(:,condIndPairInd),interceptP(:,condIndPairInd)]
            =
            getDiscrimStats(d,p,condIndPairList{condIndPairInd},statLabel);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('processFeatSel', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m', 87)" style="font-weight:bold">processFeatSel</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',87,0)">line 87</a>)
        [featSel{subjInd,sessInd}] =
        getFeatSel(d{subjInd,sessInd},p,featSel_fov{subjInd,sessInd});
} 
visualizeFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/visualizeFeatSel.m',36,1)">36  </a>showGLMdesign(featSel{1}.GLMs)
showGLMdesign(featSel{1}.GLMs)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',3,1)">3   </a>f = figure('WindowStyle','docked');
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbstep; end
if system_dependent('IsDebugMode')==1, dbcont; end
subplot(1,16+25,0+(1:25))
curDesign = GLMs.hrDesign;
imagesc(curDesign); colormap gray
min(curDesign(:))

ans =

     0

max(curDesign(:))

ans =

     1

curDesign = GLMs.sinDesign;
min(curDesign(:))

ans =

    -1

max(curDesign(:))

ans =

     1

curDesign = GLMs.hrDesign;
f = figure('WindowStyle','docked');
subplot(1,16+25,25+(1:16))
curDesign = GLMs.sinDesign;
imagesc(curDesign,[-1 1]); colormap gray
title('Sinusoidal Response');
ax1 = gca; ax1.XTick = []; ax1.YTick = [];
ylabel('TRs');
ax1.XTick = 1:size(curDesign,2);
ax1.Box = 'off';
ax1.TickDir = 'out';
ax1.XTickLabel = {'sin' 'cos' 'constant' 'drift' 'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''};
ax1.XTickLabelRotation = -90;
ax1.YAxis.Color = 'none';
ax1.YAxis.Label.Visible = 'on';
ax1.YAxis.Label.Color = 'k';
xVal = diff(ax1.XLim);
xWidth = ax1.Position(3);
subplot(1,16+25,0+(1:25))
curDesign = GLMs.hrDesign;
imagesc(curDesign,[-1 1]); colormap gray
title('Model-Free Response');
ax2 = gca; ax2.XTick = []; ax2.YTick = [];
ax2.XTick = 1:size(curDesign,2);
ax2.Box = 'off';
ax2.TickDir = 'out';
ax2.XTickLabel = cat(1,cellstr([repmat('t+',12,1) num2str((0:11)','%-d')]),{'drift'},{'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''}');
ax2.XTickLabelRotation = -90;
ax2.YAxis.Color = 'none';
ax2.YAxis.Label.Visible = 'on';
ax2.YAxis.Label.Color = 'k';
ax2.XTickLabel = cat(1,cellstr([repmat('t+',11,1) num2str((1:11)','%-d')]),{'drift'},{'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''}');
cellstr([repmat('t+',11,1) num2str((1:11)','%-d')])

ans =

  11×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {'t+1' }
    {'t+2' }
    {'t+3' }
    {'t+4' }
    {'t+5' }
    {'t+6' }
    {'t+7' }
    {'t+8' }
    {'t+9' }
    {'t+10'}
    {'t+11'}

tLabel = cellstr([repmat('t+',11,1) num2str((1:11)','%-d')]);
tLabel

tLabel =

  11×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {'t+1' }
    {'t+2' }
    {'t+3' }
    {'t+4' }
    {'t+5' }
    {'t+6' }
    {'t+7' }
    {'t+8' }
    {'t+9' }
    {'t+10'}
    {'t+11'}

cellstr([repmat('t+',11,1) num2str((1:11)','%-d')])

ans =

  11×1 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {'t+1' }
    {'t+2' }
    {'t+3' }
    {'t+4' }
    {'t+5' }
    {'t+6' }
    {'t+7' }
    {'t+8' }
    {'t+9' }
    {'t+10'}
    {'t+11'}

tLabel = cellstr([repmat('t+',11,1) num2str((1:11)','%-d')]);
ax2.XTickLabel = cat(1,tLabel,{'base (t0)'});
tLabel = cellstr([repmat('t0+',11,1) num2str((1:11)','%-d')]);
ax2.XTickLabel = cat(1,tLabel,{'base (t0)'});
tLabel = cellstr([repmat('t_0+',11,1) num2str((1:11)','%-d')]);
ax2.XTickLabel = cat(1,tLabel,{'base (t0)'});
ax2.XTickLabel = cat(1,tLabel,{'t0 (baseline)'});
ax2.XTickLabel = cat(1,tLabel,{'t0 (base)'});
ax2.XTickLabel = cat(1,tLabel,{'t0 (base)' 'drift'});
{Error using <a href="matlab:matlab.internal.language.introspective.errorDocCallback('cat')" style="font-weight:bold">cat</a>
Dimensions of arrays being concatenated are not consistent.
} 
ax2.XTickLabel = cat(1,tLabel,{'t0 (base)'},{'drift'});
f = figure('WindowStyle','docked');

subplot(1,16+25,25+(1:16))
curDesign = GLMs.sinDesign;
imagesc(curDesign,[-1 1]); colormap gray
title('Sinusoidal Response');
ax1 = gca; ax1.XTick = []; ax1.YTick = [];
%     xlabel('Regressors');
ylabel('TRs');
ax1.XTick = 1:size(curDesign,2);
ax1.Box = 'off';
ax1.TickDir = 'out';
ax1.XTickLabel = {'sin' 'cos' 'constant' 'drift' 'x' 'y' 'z' 'pitch' 'roll' 'yaw' 'x''' 'y''' 'z''' 'pitch''' 'roll''' 'yaw'''};
ax1.XTickLabelRotation = -90;
ax1.YAxis.Color = 'none';
ax1.YAxis.Label.Visible = 'on';
ax1.YAxis.Label.Color = 'k';

xVal = diff(ax1.XLim);
xWidth = ax1.Position(3);

subplot(1,16+25,0+(1:25))
% GLMs.hrDesign(:,1:end-2)
curDesign = GLMs.hrDesign;
imagesc(curDesign,[-1 1]); colormap gray
title('Model-Free Response');
ax2 = gca; ax2.XTick = []; ax2.YTick = [];
%     xlabel('Regressors');% ylabel('TRs');
ax2.XTick = 1:size(curDesign,2);
ax2.Box = 'off';
ax2.TickDir = 'out';
tLabel = cellstr([repmat('t_0+',11,1) num2str((1:11)','%-d')]);
ax2.XTickLabel = cat(1,tLabel,{'t0 (base)'},{'drift'});
ax2.XTickLabelRotation = -90;
ax2.YAxis.Color = 'none';
ax2.YAxis.Label.Visible = 'on';
ax2.YAxis.Label.Color = 'k';
suptitle('Design Matrices (random-effect)');
ax1.XAxis.FontSize = ax1.XAxis.FontSize*0.8;
ax2.XAxis.FontSize = ax2.XAxis.FontSize*0.8;
ax = [ax1 ax2];
for i = 1:length(ax)
    curAxe = ax(i);
    curAxeB = axes();
    linkprop([curAxe curAxeB],'position'); linkprop([curAxe curAxeB],'XLim');
    curAxeB.Color = 'none'; curAxeB.Box = 'on';
    curAxeB.XTick = []; curAxeB.YTick = [];
    %         delta = mode(diff(curAxe.XTick));
    %         curAxeB.XTick = [curAxe.XTick curAxe.XTick(end)+delta]-delta/2;
    %         curAxeB.TickLength = [0 0];
    %         curAxeB.XTickLabel = [];
    %         curAxeB.XGrid = 'on';
    %         curAxeB.GridAlpha = 1;
end
f = figure('WindowStyle','docked');
GLMs

GLMs = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

dbquit
featSel

featSel =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

featSel{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    featSeq: [1×1 struct]
       GLMs: [1×1 struct]

featSel{1}.GLMs

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'

dbquit
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
Feature Selection: processing
subj1; sess1
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',88,1)">88  </a>        featSel{subjInd,sessInd}.GLMs.sinDesign = d{subjInd,sessInd}.sinDesign;
d{subjInd,sessInd}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
       voxProp: [1×1 struct]

d{subjInd,sessInd}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
       voxProp: [1×1 struct]

p

p = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

     figOption: [1×1 struct]
    termOption: [1×1 struct]
          meta: [1×1 struct]
       featSel: [1×1 struct]
           svm: [1×1 struct]
          perm: [1×1 struct]
       subjInd: 1
       sessInd: 1

featSel_fov

featSel_fov =

  6×2 <a href="matlab:helpPopup cell" style="font-weight:bold">cell</a> array

    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}
    {1×1 struct}    {1×1 struct}

[featSel{subjInd,sessInd}] = getFeatSel(d{subjInd,sessInd},p,featSel_fov{subjInd,sessInd});
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',54,1)">54  </a>if p.featSel.act.doIt
p.featSel.act.doIt

ans =

     1

if system_dependent('IsDebugMode')==1, dbstep; end
d.featSel

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

       F: [1×1 struct]
    vein: [1×1 struct]

d.featSel.F

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          act: [1×1 struct]
    cond1v2v3: [1×1 struct]
      cond1v2: [1×1 struct]
      cond1v3: [1×1 struct]
      cond2v3: [1×1 struct]

d.featSel.F.act

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         F: [3419×1 double]
         p: [3419×1 double]
        df: [1×1 struct]
    design: [1×1 struct]

d.featSel.F.act.design

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    full: [2160×42 double]
     red: [2160×36 double]

dbquit
d.featSel.F.act.design
{Dot indexing is not supported for variables of this type.
} 
d{subjInd,sessInd}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

           sin: [5-D double]
       sinBase: [5-D double]
            hr: [6-D double]
        hrBase: [5-D double]
          info: 'x X y X z X rep X cond X t'
     sinDesign: [120×4 double]
      hrDesign: [120×13 double]
    infoDesign: 't X regressor'
       featSel: [1×1 struct]
       voxProp: [1×1 struct]

d{subjInd,sessInd}.featSel

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

       F: [1×1 struct]
    vein: [1×1 struct]

d{subjInd,sessInd}.featSel.F

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

          act: [1×1 struct]
    cond1v2v3: [1×1 struct]
      cond1v2: [1×1 struct]
      cond1v3: [1×1 struct]
      cond2v3: [1×1 struct]

d{subjInd,sessInd}.featSel.F.act

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

         F: [3419×1 double]
         p: [3419×1 double]
        df: [1×1 struct]
    design: [1×1 struct]

d{subjInd,sessInd}.featSel.F.act.design

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    full: [2160×42 double]
     red: [2160×36 double]

figure('WindowStyle','docked');
imagesc(d{subjInd,sessInd}.featSel.F.act.design.full)
featSel{subjInd,sessInd}.GLMs.fixed.sinDesign = d{subjInd,sessInd}.featSel.F.act.design.full;
dbquit
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
Feature Selection: processing
subj1; sess1
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',88,1)">88  </a>        featSel{subjInd,sessInd}.GLMs.sinDesign = d{subjInd,sessInd}.sinDesign;
if system_dependent('IsDebugMode')==1, dbstep out; end
subj2; sess1
{Operation terminated by user during <a href="matlab:matlab.internal.language.introspective.errorDocCallback('getFeatSel>manova3', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m', 453)" style="font-weight:bold">getFeatSel>manova3</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',453,0)">line 453</a>)


In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('getFeatSel>getDiscrimStats', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m', 307)" style="font-weight:bold">getFeatSel>getDiscrimStats</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',307,0)">line 307</a>)
    [stat,PVAL] = manova3(Xmat,Ymat(:,:,voxInd),C_MV,A,D,statLabel);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('getFeatSel', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m', 22)" style="font-weight:bold">getFeatSel</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/getFeatSel.m',22,0)">line 22</a>)
            [condStat(:,condIndPairInd),condP(:,condIndPairInd),interceptStat(:,condIndPairInd),interceptP(:,condIndPairInd)]
            = getDiscrimStats(d,p,condIndPairList{condIndPairInd},statLabel);

In <a href="matlab:matlab.internal.language.introspective.errorDocCallback('processFeatSel', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m', 87)" style="font-weight:bold">processFeatSel</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/processFeatSel.m',87,0)">line 87</a>)
        [featSel{subjInd,sessInd}] =
        getFeatSel(d{subjInd,sessInd},p,featSel_fov{subjInd,sessInd});
} 
processFeatSel(p)
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/02jp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/03sk.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/04sp.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/05bm.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/06sb.mat
loading: /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/07bj.mat
Feature Selection: processing
subj1; sess1
subj2; sess1
subj3; sess1
subj4; sess1
subj5; sess1
subj6; sess1
subj1; sess2
subj2; sess2
subj3; sess2
subj4; sess2
subj5; sess2
subj6; sess2
Feature Selection: saving
Feature Selection: saved to /Users/sebastienproulx/OneDrive - McGill University/dataBig/C-derived/DecodingHR/fun/d/featSel.mat
visualizeFeatSel(p)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/matlabFun/visualizeFeatSel.m',36,1)">36  </a>showGLMdesign(featSel{1}.GLMs)
featSel{1}

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    featSeq: [1×1 struct]
       GLMs: [1×1 struct]

featSel{1}.GLMs

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    random: [1×1 struct]
     fixed: [1×1 struct]

showGLMdesign(featSel{1}.GLMs.random)
{Unrecognized function or variable 'repo'.

Error in <a href="matlab:matlab.internal.language.introspective.errorDocCallback('showGLMdesign', '/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m', 58)" style="font-weight:bold">showGLMdesign</a> (<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',58,0)">line 58</a>)
load(fullfile(repo,funDir,outDir,subjList{subjInd},'v1SinCos.mat'),'results')
} 
opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',58,0)
showGLMdesign(featSel{1}.GLMs.random)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',57,1)">57  </a>f = figure('WindowStyle','docked');
dbquit
showGLMdesign(featSel{1}.GLMs)
<a href="matlab: opentoline('/Users/sebastienproulx/Documents/GitHub/McGill/neuroimaging/showGLMdesign.m',3,1)">3   </a>f = figure('WindowStyle','docked');
if system_dependent('IsDebugMode')==1, dbcont; end
GLMs.fixed

ans = 

  <a href="matlab:helpPopup struct" style="font-weight:bold">struct</a> with fields:

    sinDesign: [2160×42 double]

curDesign = GLMs.fixed.sinDesign;
imagesc(curDesign,[-1 1]); colormap gray
f = figure('WindowStyle','docked');
curDesign = GLMs.fixed.sinDesign;
imagesc(curDesign,[-1 1]); colormap gray
if system_dependent('IsDebugMode')==1, dbquit all; end
close all
exit
